<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_cb_design_topic">
    <sys_cb_design_topic action="INSERT_OR_UPDATE">
        <compiled_topic display_value="Submit a Request">93744c6a2fb82110c9d3bcb62799b690</compiled_topic>
        <design_definition>{"type":"FlowTopic","triggers":[{"type":"Trigger","name":"2246c8acd0db44ad95e543c2b051856e","triggerType":"request","applicability":{"type":"Applicability","mode":"script","value":"true"},"id":"2246c8acd0db44ad95e543c2b051856e"}],"goals":[{"name":"primary","trigger_id":"2246c8acd0db44ad95e543c2b051856e","nodes":[{"type":"StartGoal","goal_id":"primary","greeting_msg":{"type":"String","mode":"string","value":""},"id":"c018ceecc9ec4eca8d73f46119b9345f","name":"Start"},{"type":"TerminateGoal","goal_id":"primary","confirmation_msg":{"type":"String","mode":"string","value":""},"id":"1950987b68654630b7ada316504d4f7e","name":"End"},{"type":"LibraryCall","library_topic_name":"Search Catalog Item","library_topic_id":"ccaacd71c3a3330012d1758a7ff57ecd","parameter-mappings":[{"parameter-name":"catalogs","value":{"type":"String","mode":"string","value":"{{vaVars.catalogs_tobe_searched}}"},"metadata":{"type":"String","list":false,"items":[],"use_items":false}},{"parameter-name":"query_term","value":{"type":"String","mode":"string","value":"{{vaInputs.search_term}}"},"metadata":{"type":"String","list":false,"items":[],"use_items":false}}],"return-value-mappings":[{"main_topic_variable_namespace":"vaInputs","library_topic_return_parameter_name":"catalog_item_id","main_topic_mapped_variable_name":"catalog_item_id"},{"main_topic_variable_namespace":"vaInputs","library_topic_return_parameter_name":"item_type","main_topic_mapped_variable_name":"item_type"},{"main_topic_variable_namespace":"vaInputs","library_topic_return_parameter_name":"is_conversational","main_topic_mapped_variable_name":"is_conversational"}],"id":"785872012918461eb375221859458664","name":"Search Catalog Item","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"InputPrompt","variable_id":"d777681b391c45be8e006a68882042a1","message":{"type":"String","mode":"string","value":"gs.getMessageLang(\"What are you looking for?\", vaContext.getRequesterLang())"},"nlu_entity_binding":{"type":"NLUEntityBinding","allow_text_input":true,"use_confirmation_prompt":false},"skippable":{"type":"Applicability","mode":"script","value":"false"},"id":"7adbd65666db45418e9d6226b2ed4052","name":"Search Term","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"},"formatType":"Text","validationScript":""},{"type":"LinkOutputPrompt","header":{"type":"String","mode":"string","value":"gs.getMessageLang(\"Please click on the link below to complete the request:\", vaContext.getRequesterLang())"},"label":{"type":"String","mode":"script","value":"(function execute() {\n    return JSON.parse(vaVars.selected_item).title;\n})()\n"},"url":{"type":"String","mode":"script","value":"(function execute() {\n    return vaVars.baseUri+JSON.parse(vaVars.selected_item).selected_link;\n})()\n"},"link_type":"single","multi_link_script":"","id":"864a8758c5c94cb3a0914f99036fefa2","name":"Display link","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"ScriptedAction","script":"(function execute() {\n        var catItemObj = new sn_sc.CatItem(vaInputs.catalog_item_id);\n        var catItemJson = catItemObj.read({\n            \"name\" : \"\"\n        }, true);\n        var itemJSON = {'sys_id': vaInputs.catalog_item_id, 'title': catItemJson.name, 'selected_link':''};\n        if(vaVars.portal == null)\n            itemJSON.selected_link = vaVars.default_portal;\n        else\n            itemJSON.selected_link = vaVars.portal;\n        itemJSON.selected_link = itemJSON.selected_link + '?id=sc_cat_item&amp;sys_id=' + vaInputs.catalog_item_id;\n        vaVars.selected_item = JSON.stringify(itemJSON);\n})()\n","id":"a1eb716202394f0b9b6c3a7e57c37ae1","name":"Fetch Catalog Info","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"InputPrompt","variable_id":"ce73cb729cf7459f94b1e301fc0f1e7d","message":{"type":"String","mode":"script","value":"(function execute() {\n    return gs.getMessage('Do you want to proceed with \\'{0}\\'?', [JSON.parse(vaVars.selected_item).title]);\n})()\n"},"nlu_entity_binding":{"type":"NLUEntityBinding","allow_text_input":false,"use_confirmation_prompt":true},"skippable":{"type":"Applicability","mode":"script","value":"false"},"id":"2b60ae64e7004979b74c352e7a41f3d1","name":"Proceed","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"}},{"type":"Decision","name":"Decision","branches":[{"type":"Branch","label":"Yes","expression":{"type":"Applicability","mode":"query","value":"proceed=true"},"id":"df4b0f7f201f4503a5fcd6b5d9067fd1","name":"Yes"},{"type":"Branch","label":"No","expression":{"type":"Applicability","mode":"query","value":"proceed="},"id":"355e92b332dc4a7786c0f14193e25479","name":"No"}],"id":"1f215a5036d4474aaf48fc859be7fcd3","goal_id":"primary"},{"type":"OutputPrompt","value":{"type":"String","mode":"string","value":"gs.getMessageLang(\"Okay, let's try again\", vaContext.getRequesterLang())"},"id":"409a96c829ba4765abcd31ba46da9c61","name":"Try again","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"},"secure":false},{"type":"Decision","name":"Decision","branches":[{"type":"Branch","label":"Catalog item selected","expression":{"type":"Applicability","mode":"query","value":"catalog_item_idISNOTEMPTY"},"id":"f2162c3bf580403c9645b7004e36da31","name":"Catalog item selected"},{"type":"Branch","label":"No Catalog selected","expression":{"type":"Applicability","mode":"query","value":"catalog_item_idISEMPTY"},"id":"d5aa09ec2458451bb2b8a15aa6783401","name":"No Catalog selected"}],"id":"e7becb5a1def481dafb18a3afebcfce2","goal_id":"primary"},{"type":"OutputPrompt","value":{"type":"String","mode":"string","value":"gs.getMessageLang(\"Sorry, but I couldn't find any relevant items.\", vaContext.getRequesterLang())"},"id":"cd6230220e714f439065d533ecff9903","name":"No Catalog items ack","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"},"secure":false},{"type":"Decision","name":"Decision","branches":[{"type":"Branch","label":"true","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return (!gs.nil(vaVars.catalogs_tobe_searched) &amp;&amp; !gs.nil(vaVars.portal)) || gs.nil(vaVars.portal);\n})()\n"},"id":"8b5b6d0a0877410cb3e4f9189cdecc56","name":"true"},{"type":"Branch","label":"false","expression":{"type":"Applicability","mode":"script","value":"(function execute() {\n    return (gs.nil(vaVars.catalogs_tobe_searched) &amp;&amp; !gs.nil(vaVars.portal));\n})()\n"},"id":"0541ac4f3ae64d9491d1f6f2ac22a797","name":"false"}],"id":"e4d0ce7a3c5845c99d4531026010df54","goal_id":"primary"},{"type":"ScriptedAction","script":"(function execute() {\n    var catalogArray = [];\n    if(!gs.nil(vaVars.portal)) {\n        var portal_catalog = new GlideRecord('m2m_sp_portal_catalog');\n        portal_catalog.addQuery('sp_portal.url_suffix', vaVars.portal);\n        portal_catalog.addActiveQuery();\n        portal_catalog.query();\n        \n        while (portal_catalog.next()) {\n            catalogArray.push(portal_catalog.getValue('sc_catalog'));\n        }\n    }\n    vaVars.catalogs_tobe_searched = catalogArray.join();\n})()\n","id":"da289ceca85348dd940c175796001a42","name":"Portal Catalogs","goal_id":"primary","applicability":{"type":"Applicability","mode":"script","value":"true"}}],"edges":[{"type":"Edge","source_node_id":"c018ceecc9ec4eca8d73f46119b9345f","target_node_id":"7adbd65666db45418e9d6226b2ed4052","id":"810c7e25f1c440dab5ad02abdf8c0c52"},{"type":"Edge","source_node_id":"a1eb716202394f0b9b6c3a7e57c37ae1","target_node_id":"2b60ae64e7004979b74c352e7a41f3d1","id":"203e3c7e410b4cd19e39092c51158478"},{"type":"Edge","source_node_id":"864a8758c5c94cb3a0914f99036fefa2","target_node_id":"1950987b68654630b7ada316504d4f7e","id":"6bcea871fed14281a0b5bce6c724abdb"},{"type":"Edge","source_node_id":"2b60ae64e7004979b74c352e7a41f3d1","target_node_id":"1f215a5036d4474aaf48fc859be7fcd3","id":"6c53148865cd4ab491ef12ee3e32580a"},{"type":"Edge","source_node_id":"1f215a5036d4474aaf48fc859be7fcd3","target_node_id":"864a8758c5c94cb3a0914f99036fefa2","branch_id":"df4b0f7f201f4503a5fcd6b5d9067fd1","id":"23c2c63292d94178ac27d0896a574e87","name":"df4b0f7f201f4503a5fcd6b5d9067fd1"},{"type":"Edge","source_node_id":"1f215a5036d4474aaf48fc859be7fcd3","target_node_id":"409a96c829ba4765abcd31ba46da9c61","branch_id":"355e92b332dc4a7786c0f14193e25479","id":"d97bdf0e7a8242a8bfc1b630a013082a","name":"355e92b332dc4a7786c0f14193e25479"},{"type":"Edge","source_node_id":"409a96c829ba4765abcd31ba46da9c61","target_node_id":"7adbd65666db45418e9d6226b2ed4052","id":"e2cbc8defbd34cf6bb31192887aeda1e"},{"type":"Edge","source_node_id":"785872012918461eb375221859458664","target_node_id":"e7becb5a1def481dafb18a3afebcfce2","id":"50d99ba2bad84554ac8fdd641e2c9bcf"},{"type":"Edge","source_node_id":"cd6230220e714f439065d533ecff9903","target_node_id":"1950987b68654630b7ada316504d4f7e","id":"e0754712234f4a6d86e20c38d7eff4f1"},{"type":"Edge","source_node_id":"e7becb5a1def481dafb18a3afebcfce2","target_node_id":"a1eb716202394f0b9b6c3a7e57c37ae1","branch_id":"f2162c3bf580403c9645b7004e36da31","id":"634b08ef39c24412b0df36086b2fcb17","name":"f2162c3bf580403c9645b7004e36da31"},{"type":"Edge","source_node_id":"e7becb5a1def481dafb18a3afebcfce2","target_node_id":"cd6230220e714f439065d533ecff9903","branch_id":"d5aa09ec2458451bb2b8a15aa6783401","id":"997ca8ff305c49dca5e3116ff611cfe9","name":"d5aa09ec2458451bb2b8a15aa6783401"},{"type":"Edge","source_node_id":"e4d0ce7a3c5845c99d4531026010df54","target_node_id":"785872012918461eb375221859458664","branch_id":"8b5b6d0a0877410cb3e4f9189cdecc56","id":"4aa2cc71446d4160b59fd37ae11c4322","name":"8b5b6d0a0877410cb3e4f9189cdecc56"},{"type":"Edge","source_node_id":"e4d0ce7a3c5845c99d4531026010df54","target_node_id":"cd6230220e714f439065d533ecff9903","branch_id":"0541ac4f3ae64d9491d1f6f2ac22a797","id":"a864657b2cff46b7981dbce2cf275e1b","name":"0541ac4f3ae64d9491d1f6f2ac22a797"},{"type":"Edge","source_node_id":"7adbd65666db45418e9d6226b2ed4052","target_node_id":"da289ceca85348dd940c175796001a42","id":"61d3b183256b4b3683ae04e8635c1c18"},{"type":"Edge","source_node_id":"da289ceca85348dd940c175796001a42","target_node_id":"e4d0ce7a3c5845c99d4531026010df54","id":"92ff136152474160a505c5ccfb4542b7"}],"id":"primary"}],"script_variables":[{"type":"String","name":"selected_item","value":{"type":"String","mode":"string"},"list":false,"id":"c74f6c2bbb38452bb7cf28dbd0a12567","formatType":"text","secure":false,"sensitive":false},{"type":"String","name":"portal","value":{"type":"String","mode":"script","value":"(function execute() {\n    return vaContext.portal == undefined ? null : vaContext.portal;\n})()"},"list":false,"id":"6ef0d4e8047e46caa2b745bee60dd0bf","formatType":"text","secure":false,"sensitive":false},{"type":"String","name":"default_portal","value":{"type":"String","mode":"string","value":"csm"},"list":false,"id":"f5257be380124e008398398e5c893dce","formatType":"text","secure":false,"sensitive":false},{"type":"String","name":"baseUri","value":{"type":"String","mode":"script","value":"(function execute() {\n    return gs.getProperty('glide.servlet.uri');\n})()\n"},"list":false,"id":"4d80b43edadd4ace952aee9484a131f5","formatType":"text","secure":false,"sensitive":false},{"type":"String","name":"catalogs_tobe_searched","value":{"type":"String","mode":"string"},"list":false,"id":"bffb3a2307be411589b1fd05fa1831ef","formatType":"text","secure":false,"sensitive":false}],"glide_variables":[{"type":"String","name":"search_term","list":false,"id":"d777681b391c45be8e006a68882042a1","formatType":"Text","validationScript":"","secure":false,"sensitive":false},{"type":"True/False","id":"ce73cb729cf7459f94b1e301fc0f1e7d","name":"proceed","formatType":"text","secure":false,"sensitive":false,"list":false},{"type":"String","name":"catalog_item_id","list":false,"id":"f40008621f134cefa7598b789c9f2090","formatType":"text","metadata":{"libraryMappingType":"output"},"secure":false,"sensitive":false},{"type":"String","name":"item_type","list":false,"id":"d950964ea9d04a819f09f4ef5e0c10d6","formatType":"text","metadata":{"libraryMappingType":"output"},"secure":false,"sensitive":false},{"type":"String","name":"is_conversational","list":false,"id":"8dc3d1dd40da40fc9ec1591dad3329e0","formatType":"text","metadata":{"libraryMappingType":"output"},"secure":false,"sensitive":false},{"type":"Reference","table":"sys_user","id":"138ee251e900425e8b9a7ae2a8c105d4","name":"user","formatType":"text","secure":false,"sensitive":false,"list":false}],"applicability":{"type":"Applicability","mode":"script","value":"true"},"roles":["admin","virtual_agent_admin","sn_customerservice.customer","sn_customerservice.consumer"],"scope":"6ead8e780f603200cd674f8ce1050ed1","domain":"global","topic_type":"STANDARD","channels":[],"id":"edf3442a2fb82110c9d3bcb62799b6eb","name":"Submit a Request","key_phrases":["Submit a Request","Submit Request"],"nlu_provider":"","nlu_model":"","nlu_model_label":"","nlu_intent":"","nlu_intent_label":"","flexible_conversation_switching":false,"autopilot_topic":false,"design_categories":[{"name":null,"visible":false,"sysId":"b28634c4b7b93300da7ab948ee11a93a"}],"triggerable_by_notification":false,"library":false,"readOnly":false,"nluMapping":"[]"}</design_definition>
        <design_topic_id>edf3442a2fb82110c9d3bcb62799b6eb</design_topic_id>
        <name>Submit a Request</name>
        <sys_class_name>sys_cb_design_topic</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2023-02-06 13:36:54</sys_created_on>
        <sys_customer_update>false</sys_customer_update>
        <sys_domain>global</sys_domain>
        <sys_id>5b744c6a2fb82110c9d3bcb62799b694</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>FlowTopic</sys_name>
        <sys_package display_value="NeedIt" source="x_58872_needit">6ead8e780f603200cd674f8ce1050ed1</sys_package>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="NeedIt">6ead8e780f603200cd674f8ce1050ed1</sys_scope>
        <sys_update_name>sys_cb_design_topic_5b744c6a2fb82110c9d3bcb62799b694</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2023-02-06 13:36:54</sys_updated_on>
        <type>FlowTopic</type>
    </sys_cb_design_topic>
</record_update>
